!function(e){var t={};function s(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);class i{addEventListener(e,t){this._handlers||(this._handlers={}),this._handlers[e]||(this._handlers[e]=[]),this._handlers[e].push(t)}removeEventListener(e,t){this._handlers&&this._handlers[e]&&(this._handlers[e]=this._handlers[e].filter(e=>e!==t))}dispatchEvent(e){e.eventName&&this._handlers&&this._handlers[e.eventName]&&this._handlers[e.eventName].forEach(t=>t(e))}}class r extends i{constructor(e){super(),this.iframe=e,this.counter=Date.now(),this.ready=new Promise(this.ready.bind(this)),this._listener=this.onMessage.bind(this),window.addEventListener("message",this._listener);try{this.sendData("getApi")}catch(e){}}ready(e,t){this.rejectTimer=setTimeout(t,15e3),this.resolveReady=(()=>{clearTimeout(this.rejectTimer),delete this.rejectTimer,this.ready=!0,delete this.resolveReady,e()})}destroy(){window.removeEventListener("message",this._listener)}handleEvent(e){this.dispatchEvent(e)}onMessage(e){if(console.log("rx",e,this),e.source!=this.iframe.contentWindow)return;let t=JSON.parse(e.data);switch(t.type){case"ready":this.sendData("getApi");break;case"event":this.handleEvent(t.data);break;case"api":this.bootstrap(t.data);break;case"methodResponse":this.handlePromise(t.data)}}bootstrap(){this.resolveReady()}send(e,t,s){if(!0!==this.ready&&!s)throw Error("Not ready");return this.pending||(this.pending={}),new Promise((s,i)=>{let r=this.counter++;this.sendData("method",{methodName:e,methodId:r,args:t}),this.pending[r]=[s,i,setTimeout(5e3,i)]})}handlePromise(e){console.log("promise",e);let t=this.pending[e.methodId];if(!t)throw Error("Something really bad happened internally, trying to reference a promise that no longer exists");t[0](e),clearTimeout(t[2]),delete this.pending[e.methodId]}post(e){this.iframe.contentWindow.postMessage(e,"https://www.mixcloud.com")}sendData(e,t){this.post(JSON.stringify({type:e,data:t}))}}class n extends i{constructor(e,t){super();var s=this.iframe=document.createElement("iframe");s.style.display="none",s.src="https://www.mixcloud.com/widget/iframe/?feed="+escape(e),document.body.appendChild(s),this.ready(),this.mixcloud=new r(s),this.mixcloud.ready.then(s=>{this.load(e,t).then(e=>{console.log("mawp"),this.readyResolve(),t&&this.play()})})}ready(){this.ready=new Promise((e,t)=>{this.readyResolve=e}).then(e=>{delete this.readyResolve})}destroy(){this.mixcloud.destoy(),document.body.removeChild(this.iframe)}load(e,t){return this.mixcloud.send("load",[e,t])}play(){return this.mixcloud.send("play")}pause(){return this.mixcloud.send("pause")}toggle(){return this.mixcloud.send("togglePlay")}}s.d(t,"Mixcloud",function(){return r}),s.d(t,"Playback",function(){return n}),window.Mixcloud=r,window.Playback=n}]);